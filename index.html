<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Race Control Tracker</title>
    <style>
        /* --- MOTORSPORT THEME CSS --- */
        body { 
            font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            margin: 0; padding: 0; 
            background-color: #0d0d0d; 
            background-image: 
                linear-gradient(45deg, #1a1a1a 25%, transparent 25%, transparent 75%, #1a1a1a 75%, #1a1a1a),
                linear-gradient(45deg, #1a1a1a 25%, transparent 25%, transparent 75%, #1a1a1a 75%, #1a1a1a);
            background-size: 4px 4px;
            background-position: 0 0, 2px 2px;
            color: #e0e0e0; 
            overflow-x: hidden; 
        }
        
        .app-layout { display: flex; min-height: 100vh; }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 250px; background: #111; border-right: 2px solid #333;
            display: flex; flex-direction: column; padding: 20px; position: fixed; height: 100%; z-index: 100;
            transition: transform 0.3s ease; box-shadow: 2px 0 10px rgba(0,0,0,0.5);
        }
        .sidebar-title { 
            font-size: 1.1rem; font-weight: 900; color: #fff; margin-bottom: 30px; padding-left: 10px; 
            text-transform: uppercase; letter-spacing: 2px; border-left: 4px solid #ff3b30; padding-left: 15px; font-style: italic;
        }
        .nav-item {
            padding: 12px 15px; margin-bottom: 8px; border-radius: 4px; color: #666; text-decoration: none;
            font-size: 0.85rem; font-weight: bold; text-transform: uppercase; display: flex; align-items: center; gap: 10px;
            transition: 0.2s; cursor: pointer; border: 1px solid transparent;
        }
        .nav-item:hover { background: #222; color: #fff; border-color: #444; }
        .nav-item.active { background: #222; color: #ff3b30; border-color: #ff3b30; }
        
        /* --- MAIN CONTENT --- */
        .main-content { flex: 1; margin-left: 250px; padding: 20px; display: flex; justify-content: center; align-items: flex-start; }
        .view-container { width: 100%; max-width: 600px; text-align: center; margin-bottom: 80px; display: none; }
        .view-container.active-view { display: block; }

        .card-box { 
            background: #161616; padding: 25px; border-radius: 8px; border: 1px solid #333;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8); margin-bottom: 20px; position: relative;
        }
        .card-box::before, .card-box::after { content: ''; position: absolute; top: 10px; width: 4px; height: 4px; background: #333; border-radius: 50%; box-shadow: 0 0 2px #000 inset; }
        .card-box::before { left: 10px; } .card-box::after { right: 10px; }

        .menu-toggle {
            display: none; position: fixed; top: 15px; left: 15px; z-index: 101;
            background: #222; border: 1px solid #ff3b30; color: #fff; padding: 10px; border-radius: 4px; cursor: pointer; font-size: 1.2rem;
        }

        h1 { margin: 0; font-size: 1.6rem; color: #fff; margin-bottom: 5px; text-transform: uppercase; font-style: italic; letter-spacing: 1px; font-weight: 900;}
        p.subtitle { color: #666; margin-bottom: 25px; font-size: 0.75em; text-transform: uppercase; letter-spacing: 2px;}
        
        #display { 
            font-family: 'Courier New', Courier, monospace; font-size: 3.8em; margin: 15px 0 25px 0; 
            font-weight: 700; color: #fff; text-shadow: 0 0 10px rgba(255, 255, 255, 0.3); letter-spacing: -2px;
        }
        
        .input-group { margin-bottom: 20px; text-align: left; }
        .input-label { font-size: 0.7em; color: #ff3b30; margin-bottom: 5px; display: block; margin-left: 2px; text-transform: uppercase; font-weight: 800; letter-spacing: 1px;}
        
        input, select { 
            width: 100%; padding: 15px; border-radius: 6px; border: 1px solid #333; background: #000; color: #0a84ff; 
            font-family: 'Courier New', monospace; font-weight: bold; font-size: 1rem; box-sizing: border-box; outline: none; appearance: none; transition: 0.3s;
        }
        input:focus, select:focus { border-color: #0a84ff; box-shadow: 0 0 10px rgba(10, 132, 255, 0.2); }
        #fsTypeSelect, #modalCat { background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23ff3b30%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E"); background-repeat: no-repeat; background-position: right 15px center; background-size: 12px; }
        
        .status-badge { display: inline-block; padding: 4px 12px; border-radius: 4px; font-size: 0.75em; font-weight: 900; text-transform: uppercase; margin-bottom: 15px; background: #222; color: #666; letter-spacing: 1px; border: 1px solid #333;}
        
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 20px; }
        button { 
            padding: 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 800; text-transform: uppercase; letter-spacing: 0.5px;
            transition: transform 0.1s, filter 0.2s; display: flex; flex-direction: column; align-items: center; gap: 5px; font-size: 0.8rem; color: white; width: 100%;
            border-bottom: 3px solid rgba(0,0,0,0.3);
        }
        button:active { transform: translateY(2px); border-bottom-width: 0; }
        
        .btn-fs { background: linear-gradient(180deg, #ff3b30, #c41e15); } 
        .btn-uni { background: linear-gradient(180deg, #0a84ff, #0056b3); } 
        .btn-free { background: linear-gradient(180deg, #30d158, #1da33d); }
        .btn-sleep-action { background: linear-gradient(180deg, #bf5af2, #8e44ad); margin-top: 10px;}
        .btn-stop { background: repeating-linear-gradient(45deg, #2c2c2e, #2c2c2e 10px, #3a3a3c 10px, #3a3a3c 20px); border: 2px solid #ff453a; color: #ff453a; display: none; padding: 20px; font-size: 1rem; }
        
        .btn-add-event { background: #222; border: 1px dashed #666; color: #888; margin-top: 15px; }
        .btn-add-event:hover { background: #333; color: #fff; border-color: #fff; }

        .btn-import { background: #222; border: 1px solid #444; color: #666; margin-top: 5px; font-size: 0.7rem; padding: 8px; }

        .stat-filter { display: flex; justify-content: center; gap: 5px; margin-top: 30px; margin-bottom: 10px; flex-wrap: wrap;}
        .stat-tab { background: #111; border: 1px solid #333; color: #666; padding: 6px 15px; border-radius: 4px; font-size: 0.75em; cursor: pointer; margin-bottom: 5px; text-transform: uppercase; font-weight: bold;}
        .stat-tab.active { background: #333; color: white; border-color: #888; }
        
        .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 20px; }
        .dash-card { background: #111; padding: 10px; border-radius: 6px; text-align: left; border-left: 3px solid #333; }
        .dash-label { font-size: 0.6em; text-transform: uppercase; color: #666; font-weight: 900; display: block; margin-bottom: 5px; }
        .dash-val { font-size: 1.2em; font-weight: 700; color: #fff; display: block; font-family: 'Courier New', monospace;}
        .dash-sub { font-size: 0.6em; color: #444; font-weight: normal; margin-top: 2px; display: block; text-transform: uppercase;}

        .chart-container { margin-top: 20px; padding: 20px; background: #111; border-radius: 6px; border: 1px solid #333; }
        .bar-chart { display: flex; align-items: flex-end; justify-content: space-between; height: 120px; padding-bottom: 20px; }
        .bar-col { display: flex; flex-direction: column; align-items: center; justify-content: flex-end; height: 100%; width: 12%; }
        .stacked-bar { width: 100%; border-radius: 2px; overflow: hidden; display: flex; flex-direction: column-reverse; background: #222; min-height: 2px; transition: height 0.5s;}
        .segment { width: 100%; }
        .bar-day { font-size: 0.6em; color: #666; margin-top: 5px; font-family: 'Courier New', monospace; font-weight: bold;}

        .sleep-section { background: #111; padding: 15px; border-radius: 6px; margin-top: 20px; border: 1px solid #333; border-left: 3px solid #bf5af2;}
        .sleep-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

        .btn-export { background: transparent; border: 1px solid #444; color: #666; padding: 10px; font-size: 0.75em; margin-top: 30px; width: auto; display: inline-block; border-radius: 4px; text-transform: uppercase; font-weight: bold;}
        .log-list { list-style: none; padding: 0; text-align: left; margin-top: 25px; font-size: 0.9em; }
        .log-list li { padding: 10px 0; border-bottom: 1px dashed #333; display: grid; grid-template-columns: 1fr auto auto; align-items: center; gap: 10px;}
        .btn-delete { background: none; border: none; color: #444; font-size: 1.2em; padding: 5px; cursor: pointer;}
        .log-note { display: block; color: #666; font-style: italic; font-size: 0.85em; }
        .sub-tag { display: inline-block; font-size: 0.7em; background: #222; padding: 2px 6px; border-radius: 2px; color: #ccc; margin-left: 5px; vertical-align: middle; border: 1px solid #444;}

        /* --- CALENDAR STYLES --- */
        .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .cal-btn { background: #222; border: 1px solid #444; color: #fff; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .cal-title { font-size: 1.1em; font-weight: 900; text-transform: uppercase; color: #fff; }
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-bottom: 20px; }
        .cal-head-day { text-align: center; font-size: 0.6em; color: #666; font-weight: bold; text-transform: uppercase; padding-bottom: 5px;}
        
        .cal-day { 
            background: #111; border: 1px solid #2a2a2a; height: 50px; border-radius: 4px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; position: relative; transition: 0.2s;
        }
        .cal-day:hover { border-color: #666; background: #1a1a1a; }
        .cal-day.active { border-color: #ff3b30; background: #1a1a1a; box-shadow: 0 0 10px rgba(255,59,48,0.2); }
        .cal-day.empty { background: transparent; border: none; cursor: default; }
        
        .cal-num { font-size: 0.8em; font-weight: bold; color: #888; }
        .cal-val { font-size: 0.7em; font-weight: 800; color: #fff; margin-top: 2px; font-family: 'Courier New', monospace; }
        
        .cal-dots { display: flex; gap: 2px; margin-top: 3px; height: 3px; width: 80%; justify-content: center;}
        .cal-dot { width: 100%; height: 100%; border-radius: 1px; opacity: 0.8; }
        
        .cal-event-mark {
            position: absolute; top: 2px; right: 2px; width: 0; height: 0; 
            border-left: 6px solid transparent; border-top: 6px solid #fff;
        }

        .detail-box { background: #111; padding: 15px; border-radius: 6px; border: 1px solid #333; margin-top: 20px; display: none; }
        .detail-box.show { display: block; animation: fadeIn 0.3s; }
        .detail-title { font-size: 0.8em; font-weight: 900; text-transform: uppercase; color: #666; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px; display: flex; justify-content: space-between;}

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 200;
            display: none; align-items: center; justify-content: center;
        }
        .modal { background: #161616; border: 1px solid #333; padding: 25px; border-radius: 8px; width: 90%; max-width: 400px; box-shadow: 0 0 30px rgba(0,0,0,0.8); }
        .modal h2 { font-size: 1.2rem; text-transform: uppercase; font-style: italic; margin-top: 0; color: #fff; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); width: 250px; }
            .sidebar.open { transform: translateX(0); box-shadow: 5px 0 20px rgba(0,0,0,0.5); }
            .main-content { margin-left: 0; padding-top: 60px; }
            .menu-toggle { display: block; }
        }
    </style>
</head>
<body>

<div class="modal-overlay" id="eventModal">
    <div class="modal">
        <h2>New Schedule Entry</h2>
        <div class="input-group">
            <span class="input-label">Title / Event</span>
            <input type="text" id="modalTitle" placeholder="Meeting, Deadline, Race...">
        </div>
        <div class="input-group">
            <span class="input-label">Category</span>
            <select id="modalCat">
                <option value="FS">üèéÔ∏è FS Team</option>
                <option value="Uni">üéì Uni</option>
                <option value="Freizeit">üèñÔ∏è Freizeit</option>
                <option value="Sonstiges">‚ö™ Sonstiges</option>
            </select>
        </div>
        <div class="input-group">
            <span class="input-label">Time (Optional)</span>
            <input type="time" id="modalTime">
        </div>
        <div class="btn-grid" style="grid-template-columns: 1fr 1fr; margin-bottom:0;">
            <button onclick="closeModal()" style="background:#333;">Cancel</button>
            <button onclick="saveEvent()" class="btn-uni">Save Entry</button>
        </div>
    </div>
</div>

<button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>

<div class="app-layout">
    <div class="sidebar" id="sidebar">
        <div class="sidebar-title">üèÅ Race Control</div>
        <div class="nav-item active" id="nav-dashboard" onclick="showView('dashboard')"><span>üè†</span> Dashboard</div>
        <div class="nav-item" id="nav-tracker" onclick="showView('tracker')"><span>‚è±Ô∏è</span> Telemetry</div>
        <div class="nav-item" id="nav-calendar" onclick="showView('calendar')"><span>üìÖ</span> Schedule</div>
    </div>

    <div class="main-content">
        
        <div id="view-dashboard" class="view-container active-view">
            <div class="card-box">
                <h1>Overview</h1>
                <p class="subtitle">Season 25/26 ‚Ä¢ v7.8</p>
                <p class="input-label" style="text-align:center; margin-bottom:10px;">Quick Launch</p>
                <div class="btn-grid start-buttons-container">
                    <button class="btn-fs" onclick="startWork('FS')">üèéÔ∏è FS Team</button>
                    <button class="btn-uni" onclick="startWork('Uni')">üéì Uni</button>
                    <button class="btn-free" onclick="startWork('Freizeit')">üèñÔ∏è Freizeit</button>
                </div>
                <div class="chart-container">
                    <span class="dash-label" style="margin-bottom:15px">Weekly Pace</span>
                    <div class="bar-chart" id="weekChartDash"></div>
                </div>
                <div style="margin-top:20px; font-size:0.7em; color:#444; text-transform:uppercase;">
                    Career Total: <span id="totalHours" style="color:#fff; font-weight:bold; font-family:'Courier New'">0</span>h
                </div>
            </div>
        </div>

        <div id="view-tracker" class="view-container">
            <div class="card-box">
                <h1>
